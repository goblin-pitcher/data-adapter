!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MegviiVideoPlayer={})}(this,(function(e){"use strict";const t={retain:!1,transValue:!1,matchFullRules:!0,relativePath:!1,priority:["string","regExp","function"]},n=e=>!(!e&&0!==e),r=e=>e&&["object","function"].includes(typeof e),l=e=>[e.length>1?e.slice(0,e.length-1):[],e[e.length-1]],u=(e,t,u,a)=>{if(!r(e))return!1;const[c,o]=l(t),i=((e,t,l)=>{const u=[];let a=!1;const c=t.reduce(((e,c,o)=>{if(r(e))return!n(e[c])&&l&&(e[c]=Number.isFinite(e[c])?[]:{},u.unshift((()=>{delete e[c]}))),o===t.length-1&&(a=!0),e[c]}),e);return a||u.forEach((e=>e())),c})(e,c,a);return!!r(i)&&(i[o]=u,!0)};(()=>{const e=`#${Math.random().toString(36).substr(2,5)}#`})();const a=(e,t)=>{let n=[e];for(;n.length;){const r=n.shift();t(r,e),r.children?.length&&(n=n.concat(r.children))}},c=e=>{const t=typeof e;return"string"===t?"string":"function"===t?"function":"regExp"},o=(e,t,n,r,l)=>{let u=!1;const a=n[n.length-1],o=e[e.length-1],i=c(a);return u="string"===i?o===a:"regExp"===i?a.test(`${o}`):a(e,t,n,r,l),u},i=e=>(...t)=>{const n=((...e)=>{const t=(...e)=>{let[n,l,u,a=null]=e;const c=l.children;if(!c.length||!r(n))return n;a||(a={parent:null,children:[],path:[],value:null,rule:null,rulePath:[]},a.value=n);const o=[];return Object.keys(n).forEach((e=>{const r=a.path.concat(e),l=n[e];c.forEach((e=>{const c=e.rulePath,i=e.rule;if(!u(r,l,c,i,n))return;const h={parent:null,children:[],path:[],value:null,rule:null,rulePath:[]};h.parent=a,h.path=r,h.value=l,h.rulePath=c,h.rule=i,t(l,e,u,h),o.push(h)}))})),a.children=o,a};return t(...e)})(...t);return e?((e,t=(()=>!0))=>{const n=e=>{if(!e)return!1;const r=e.children.map((e=>n(e)?e:null)).filter(Boolean);return e.children=r,!!e.children.length||t(e)};return n(e)?e:null})(n,(e=>{if(!e.rule)return!1;const t=Array.isArray(e.rule)?e.rule.length:1;return e.rulePath.length===t})):n},h=(e,t,r,a)=>{const c=new Set;return{nodeCache:c,visit:(o,i)=>{if(!!o.children.length)return;let h=e.get(o.rule);const s=l(o.path)[1];if("function"==typeof h&&(h=h(o.path,o.value,o.rulePath,o.rule,t)),r)o.parent.value[s]=h;else{if(n(h))if(Array.isArray(h)){const e=a?o.parent?.value:i.value;u(e,h,o.value,!0)}else o.parent.value[h]=o.value;else{const e=(f=o.parent?.rule,Array.isArray(f)?f[f.length-1]:null);e&&delete o.value[e]}var f;c.add(o)}}}},s=(e,...n)=>{const r=n[0],u=(e=>({...t,..."boolean"==typeof e?{retain:e}:e}))(n[1]),{retain:s,transValue:f,relativePath:d,matchFullRules:p,priority:g}=u,y=(e=>{const t={parent:null,children:[],rulePath:[],rule:null},n=e.reduce(((e,t)=>{const n=(e=>{const t={parent:null,children:[],rulePath:[],rule:null},n=[].concat(e).map((e=>[].concat(e)));let r=[t];return n.forEach((t=>{const n=[];r.forEach((r=>{const l=t.map((t=>{const n={parent:null,children:[],rulePath:[],rule:null};return n.parent=r,n.rule=e,n.rulePath=n.parent.rulePath.concat(t),n}));r.children=l,n.push(...l)})),r=n})),t})(t);return e.concat(n.children)}),[]);return t.children=n,t})([...r.keys()]);a(y,(e=>((e,t)=>{e.children=[...e.children].sort(((e,n)=>{const[r,l]=[e,n].map((e=>e.rulePath[e.rulePath.length-1])),u=c(r),a=c(l);return t.indexOf(u)-t.indexOf(a)}))})(e,g)));const v=i(p)(e,y,o);if(!v)return e;const{nodeCache:P,visit:m}=h(r,e,f,d);return a(v,m),s||P.forEach((e=>{const t=l(e.path)[1];delete e.parent.value[t]})),e};e.default=(e,...t)=>Array.isArray(t[0])?t.reduce(((e,t)=>t.length?s(e,...t):e),e):s(e,...t),Object.defineProperty(e,"__esModule",{value:!0})}));
