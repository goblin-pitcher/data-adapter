!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MegviiVideoPlayer={})}(this,(function(e){"use strict";const t={retain:!1,transValue:!1,matchFullRules:!0,relativePath:!1,priority:["string","regExp","function"]},n=e=>!(!e&&0!==e),r=e=>e&&["object","function"].includes(typeof e),l=e=>[e.length>1?e.slice(0,e.length-1):[],e[e.length-1]],u=(e,t,u,a)=>{if(!r(e))return!1;const[c,i]=l(t),o=((e,t,l)=>{const u=[];let a=!1;const c=t.reduce(((e,c,i)=>{if(r(e))return!n(e[c])&&l&&(e[c]=Number.isFinite(e[c])?[]:{},u.unshift((()=>{delete e[c]}))),i===t.length-1&&(a=!0),e[c]}),e);return a||u.forEach((e=>e())),c})(e,c,a);return!!r(o)&&(o[i]=u,!0)},{join:a,split:c}=(()=>{const e=`#${Math.random().toString(36).substr(2,5)}#`;return{split:t=>t.split(e),join:t=>t.join(e)}})(),i=(e,t)=>{let n=[e];for(;n.length;){const r=n.shift();t(r,e),r.children?.length&&(n=n.concat(r.children))}},o=e=>{const t=typeof e;return"string"===t?"string":"function"===t?"function":"regExp"},s=e=>(...t)=>{const n=((...e)=>{const t=(...e)=>{let[n,l,u,a=null]=e;const c=l.children;if(c.length&&!r(n))return null;a||(a={parent:null,children:[],path:[],value:null,rule:null,rulePath:[]},a.value=n);const i=[];return Object.keys(n).forEach((e=>{const r=a.path.concat(e),l=n[e];c.forEach((e=>{const n=e.rulePath,c=e.rule;if(!u(r,l,n,c))return;const o={parent:null,children:[],path:[],value:null,rule:null,rulePath:[]};o.parent=a,o.path=r,o.value=l,o.rulePath=n,o.rule=c,t(l,e,u,o),i.push(o)}))})),a.children=i,a};return t(...e)})(...t);return e?((e,t=(()=>!0))=>{const n=e=>{if(!e)return!1;const r=e.children.map((e=>n(e)?e:null)).filter(Boolean);return e.children=r,!!e.children.length||t(e)};return n(e)?e:null})(n,(e=>{if(!e.rule)return!1;const t=Array.isArray(e.rule)?e.rule.length:1;return e.rulePath.length===t})):n},h=(e,...r)=>{const c=r[0],h=(e=>({...t,..."boolean"==typeof e?{retain:e}:e}))(r[1]),{retain:f,transValue:d,relativePath:p,matchFullRules:g,priority:y}=h,v=(e=>{const t={parent:null,children:[],rulePath:[],rule:null},n=e.reduce(((e,t)=>{const n=(e=>{const t={parent:null,children:[],rulePath:[],rule:null},n=[].concat(e).map((e=>[].concat(e)));let r=[t];return n.forEach((t=>{const n=[];r.forEach((r=>{const l=t.map((t=>{const n={parent:null,children:[],rulePath:[],rule:null};return n.parent=r,n.rule=e,n.rulePath=n.parent.rulePath.concat(t),n}));r.children=l,n.push(...l)})),r=n})),t})(t);return e.concat(n.children)}),[]);return t.children=n,t})([...c.keys()]);i(v,(e=>((e,t)=>{e.children=[...e.children].sort(((e,n)=>{const[r,l]=[e,n].map((e=>e.rulePath[e.rulePath.length-1])),u=o(r),a=o(l);return t.indexOf(u)-t.indexOf(a)}))})(e,y)));const P=s(g)(e,v,(()=>{const e=new Set;return(t,n,r,l)=>{const u=a(t);let c=!1;if(e.has(u))return c;const i=r[r.length-1],s=t[t.length-1],h=o(i);return c="string"===h?s===i:"regExp"===h?i.test(`${s}`):i(t,n,r,l),c&&e.add(u),c}})());if(!P)return e;const{nodeCache:m,visit:b}=((e,t,r)=>{const a=new Set;return{nodeCache:a,visit:(c,i)=>{if(c.children.length)return;let o=e.get(c.rule);const s=l(c.path)[1];if("function"==typeof o&&(o=o(c.path,c.value,c.rulePath,c.rule)),t)c.parent.value[s]=o;else{if(n(o))if(Array.isArray(o)){const e=r?c.parent?.value:i.value;u(e,o,c.value,!0)}else c.parent.value[o]=c.value;a.add(c)}}}})(c,d,p);return i(P,b),f||m.forEach((e=>{const t=l(e.path)[1];delete e.parent.value[t]})),e};e.default=(e,...t)=>Array.isArray(t[0])?t[0].reduce(((e,t)=>h(e,...t)),e):h(e,...t),Object.defineProperty(e,"__esModule",{value:!0})}));
