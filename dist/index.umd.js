!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MegviiVideoPlayer={})}(this,(function(e){"use strict";const t={retain:!1,transValue:!1,matchFullRules:!0,priority:["string","regExp","function"]},n=e=>[e.length>1?e.slice(0,e.length-1):[],e[e.length-1]],{join:r,split:l}=(()=>{const e=`#${Math.random().toString(36).substr(2,5)}#`;return{split:t=>t.split(e),join:t=>t.join(e)}})(),u=(e,t)=>{let n=[e];for(;n.length;){const e=n.shift();t(e),e.children?.length&&(n=n.concat(e.children))}},c=(e=null)=>(t,n,r)=>{const l=n.children;if(l.length&&(!(u=t)||!["object","function"].includes(typeof u)))return null;var u;e||((e={parent:null,children:[],path:[],value:null,rule:null,rulePath:[]}).value=t);const a=[];return Object.keys(t).forEach((n=>{const u=e.path.concat(n),o=t[n];l.forEach((t=>{const n=t.rulePath,l=t.rule;if(!r(u,o,n,l))return;const i={parent:null,children:[],path:[],value:null,rule:null,rulePath:[]};i.parent=e,i.path=u,i.value=o,i.rulePath=n,i.rule=l,c(i)(o,t,r),a.push(i)}))})),e.children=a,e},a=c(),o=e=>{const t=typeof e;return"string"===t?"string":"function"===t?"function":"regExp"},i=e=>(...t)=>{const n=a(...t);return e?((e,t=(()=>!0))=>{const n=e=>{if(!e)return!1;const r=e.children.map((e=>n(e)?e:null)).filter(Boolean);return e.children=r,!!e.children.length||t(e)};return n(e)?e:null})(n,(e=>{if(!e.rule)return!1;const t=Array.isArray(e.rule)?e.rule.length:1;return e.rulePath.length===t})):n},s=(e,...l)=>{const c=l[0],a=(e=>({...t,..."boolean"==typeof e?{retain:e}:e}))(l[1]),{retain:s,transValue:h,matchFullRules:d,priority:p}=a,f=(e=>{const t={parent:null,children:[],rulePath:[],rule:null},n=e.reduce(((e,t)=>{const n=(e=>{const t={parent:null,children:[],rulePath:[],rule:null},n=[].concat(e).map((e=>[].concat(e)));let r=[t];return n.forEach((t=>{const n=[];r.forEach((r=>{const l=t.map((t=>{const n={parent:null,children:[],rulePath:[],rule:null};return n.parent=r,n.rule=e,n.rulePath=n.parent.rulePath.concat(t),n}));r.children=l,n.push(...l)})),r=n})),t})(t);return e.concat(n.children)}),[]);return t.children=n,t})([...c.keys()]);u(f,(e=>((e,t)=>{e.children=[...e.children].sort(((e,n)=>{const[r,l]=[e,n].map((e=>e.rulePath[e.rulePath.length-1])),u=o(r),c=o(l);return t.indexOf(u)-t.indexOf(c)}))})(e,p)));const g=i(d)(e,f,(()=>{const e=new Set;return(t,n,l,u)=>{const c=r(t);let a=!1;if(e.has(c))return a;const i=l[l.length-1],s=t[t.length-1],h=o(i);if("string"===h)a=s===i;else if("regExp"===h)a=i.test(`${s}`);else{const e=i(t,n,l,u);a=e&&["string","symbol"].includes(typeof e)}return a&&e.add(c),a}})());if(!g)return e;const{nodeCache:y,visit:P}=((e,t)=>{const r=new Set;return{nodeCache:r,visit:l=>{if(l.children.length)return;let u=e.get(l.rule);const c=n(l.path)[1];"function"==typeof u&&(u=u(l.path,l.value,l.rulePath,l.rule)),t?l.parent.value[c]=u:(l.parent.value[u]=l.value,r.add(l))}}})(c,h);return u(g,P),s||y.forEach((e=>{const t=n(e.path)[1];delete e.parent.value[t]})),e},h=(e,...t)=>Array.isArray(t[0])?t[0].reduce(((e,t)=>s(e,...t)),e):s(e,...t);Object.assign(window,{adapter:h}),e.default=h,Object.defineProperty(e,"__esModule",{value:!0})}));
